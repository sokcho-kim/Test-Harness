# Test Harness ë¡œë“œë§µ v2

> ì‘ì„±ì¼: 2026-01-22
> ì°¸ê³  ìë£Œ: Naver D2 (í”„ë¡¬í”„íŠ¸ ì—”ì§€ë‹ˆì–´ë§ ë„êµ¬), ìš°ì•„í•œí˜•ì œë“¤ (AIí”Œë«í¼ 2.0 LLMOps)

---

## 1. í˜„ì¬ ìƒíƒœ (As-Is)

### 1.1 ì™„ë£Œëœ ì‘ì—… (Phase 1)

| í•­ëª© | íŒŒì¼ | ìƒíƒœ |
|------|------|------|
| ë°ì´í„° ëª¨ë¸ | `shared/core/models.py` | âœ… ì™„ë£Œ |
| LLM ì–´ëŒ‘í„° | `shared/adapters/` | âœ… ì™„ë£Œ |
| SQLite DB í´ë˜ìŠ¤ | `shared/database/database.py` | âœ… ì™„ë£Œ |
| FastAPI ì„œë²„ ê¸°ë³¸ ì„¤ì • | `services/api/` | âœ… ì™„ë£Œ |
| API ë¼ìš°í„° | `services/api/routers/` | ğŸ”² ìŠ¤í…ë§Œ ìˆìŒ |

### 1.2 ë°°í¬ ì¸í”„ë¼ ê²°ì •

```
Cloud Run (API + Web) + Cloud SQL (PostgreSQL)
ì˜ˆìƒ ë¹„ìš©: $50-70/ì›”
GCP $300 ë¬´ë£Œ í¬ë ˆë”§ í™•ë³´ (90ì¼)
```

### 1.3 í•´ê²°í•´ì•¼ í•  ê³¼ì œ

ê¸°ì¡´ ë°©ì‹ì˜ ë¬¸ì œì  (Naver D2, ìš°ì•„í•œ ê³µí†µ):

| ë¬¸ì œ | í˜„ìƒ | ì˜í–¥ |
|------|------|------|
| í”„ë¡¬í”„íŠ¸ íˆìŠ¤í† ë¦¬ ê´€ë¦¬ ì–´ë ¤ì›€ | ë²„ì „ì´ ì½”ë“œ/ì‹œíŠ¸/íŒŒì¼ì— ë¶„ì‚° | ì¶”ì  ë¶ˆê°€, ë¡¤ë°± ì–´ë ¤ì›€ |
| í”„ë¡¬í”„íŠ¸ ë³€ê²½ ì‹œ ë°°í¬ í•„ìš” | ì½”ë“œì— í•˜ë“œì½”ë”© | ë¯¼ì²©ì„± ì €í•˜ |
| í‰ê°€ ê²°ê³¼ íŒŒì•… ì–´ë ¤ì›€ | ì´ìŠˆ/ì‹œíŠ¸ì— ê¸°ë¡ | ì˜ì‚¬ê²°ì • ì§€ì—° |
| ì‹¤í—˜ ì¬í˜„ì„± ë¶€ì¡± | ì²´ê³„ ì—†ìŒ | ê°™ì€ ì‹¤í—˜ ë°˜ë³µ |

---

## 2. ì°¸ê³  ì•„í‚¤í…ì²˜

### 2.1 Naver D2 - í”„ë¡¬í”„íŠ¸ ì—”ì§€ë‹ˆì–´ë§ ë„êµ¬

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Streamlit UI                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚              Custom Python Library                   â”‚
â”‚         (LangChain, Ragas í™œìš©)                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                 Vitess (MySQL)                       â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚   â”‚ í”„ë¡¬í”„íŠ¸  â”‚ ì• í”Œë¦¬ì¼€ì´ì…˜â”‚ í…ŒìŠ¤íŠ¸ì…‹  â”‚   í‰ê°€   â”‚    â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**í•µì‹¬ ê°œë…**:
- `ì• í”Œë¦¬ì¼€ì´ì…˜ = ëª¨ë¸ + í”„ë¡¬í”„íŠ¸(active ë²„ì „) + LLM ì˜µì…˜`
- í”„ë¡¬í”„íŠ¸ë‹¹ active ë²„ì „ì€ 1ê°œë§Œ
- ë°°í¬ ì—†ì´ í”„ë¡¬í”„íŠ¸ ë³€ê²½ ê°€ëŠ¥

### 2.2 ìš°ì•„í•œí˜•ì œë“¤ - AIí”Œë«í¼ 2.0

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   GenAI Labs                         â”‚
â”‚            (í”„ë¡¬í”„íŠ¸ ì‹¤í—˜/í‰ê°€ UI)                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                  GenAI Studio                        â”‚
â”‚    (Langfuse ê¸°ë°˜: í”„ë¡¬í”„íŠ¸ ê´€ë¦¬, Observability)      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                   GenAI SDK                          â”‚
â”‚      (LiteLLM ê¸°ë°˜: í†µí•© ì¸í„°í˜ì´ìŠ¤, Fallback)        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚               GenAI API Gateway                      â”‚
â”‚            (OpenAI-Compatible API)                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**8ê°€ì§€ ë¬¸ì œì™€ í•´ê²° ì»´í¬ë„ŒíŠ¸**:

| ë¬¸ì œ | í•´ê²° ì „ëµ | ì»´í¬ë„ŒíŠ¸ |
|------|----------|---------|
| ë©€í‹° Provider ë³µì¡ì„± | í†µí•© ì¸í„°í˜ì´ìŠ¤ | API Gateway, SDK |
| í”„ë¡¬í”„íŠ¸ ê´€ë¦¬ í•œê³„ | ì¤‘ì•™ ì§‘ì¤‘ ê´€ë¦¬ | Studio |
| ì•ˆì •ì„± ë¬¸ì œ | Retry/Fallback, Trace | SDK, Studio |
| ë¹„ìš©/ë¦¬ì†ŒìŠ¤ ê´€ë¦¬ | í† í°/ë¹„ìš© ëŒ€ì‹œë³´ë“œ | Studio, Superset |
| ì‹¤í—˜ ê´€ë¦¬ ë¶€ì¬ | Dataset ê¸°ë°˜ í‰ê°€ | Labs, Studio |
| ìƒˆë¡œìš´ ì‚¬ìš©ìì¸µ | ì…€í”„ ì„œë¹„ìŠ¤ UI | Labs, Studio |
| í¬ë ˆë´ì…œ ë°œê¸‰ í—ˆë“¤ | ê³µìš© í‚¤ â†’ ì •ì‹ ë°œê¸‰ ë¶„ë¦¬ | ê±°ë²„ë„ŒìŠ¤ |
| ë³´ì•ˆ/ê°œì¸ì •ë³´ | PII íƒì§€/ì°¨ë‹¨ | SDK, Studio |

---

## 3. ë¡œë“œë§µ

### 3.1 Phase 2: NOW (í˜„ì¬ ë‹¨ê³„)

> ëª©í‘œ: í•µì‹¬ ê¸°ëŠ¥ ì™„ì„± ë° GCP ë°°í¬

#### 3.1.1 í”„ë¡¬í”„íŠ¸ ë²„ì €ë‹ ì‹œìŠ¤í…œ

**ë°ì´í„° ëª¨ë¸ í™•ì¥** (`shared/core/models.py`):

```python
class PromptVersion(BaseModel):
    """í”„ë¡¬í”„íŠ¸ ë²„ì „"""
    id: str
    prompt_id: str
    version: int
    content: str
    variables: list[str] = []
    is_active: bool = False      # í”„ë¡¬í”„íŠ¸ë‹¹ 1ê°œë§Œ active
    created_at: datetime
    created_by: str | None = None
    change_note: str | None = None  # ë³€ê²½ ì‚¬ìœ 

class Prompt(BaseModel):
    """í”„ë¡¬í”„íŠ¸ (ë²„ì „ ì»¨í…Œì´ë„ˆ)"""
    id: str
    name: str
    description: str | None = None
    created_at: datetime
    updated_at: datetime
    # active_versionì€ PromptVersionì—ì„œ ì¡°íšŒ

class Application(BaseModel):
    """ì• í”Œë¦¬ì¼€ì´ì…˜ = ëª¨ë¸ + í”„ë¡¬í”„íŠ¸ + ì˜µì…˜"""
    id: str
    name: str
    description: str | None = None
    model_id: str
    prompt_id: str               # active ë²„ì „ ìë™ ì‚¬ìš©
    temperature: float = 0.7
    max_tokens: int = 1024
    top_p: float | None = None
    created_at: datetime
    updated_at: datetime
```

**API ì—”ë“œí¬ì¸íŠ¸**:

| Method | Endpoint | ì„¤ëª… |
|--------|----------|------|
| GET | `/prompts` | í”„ë¡¬í”„íŠ¸ ëª©ë¡ |
| POST | `/prompts` | í”„ë¡¬í”„íŠ¸ ìƒì„± (v1 ìë™ ìƒì„±) |
| GET | `/prompts/{id}` | í”„ë¡¬í”„íŠ¸ ì¡°íšŒ (active ë²„ì „ í¬í•¨) |
| GET | `/prompts/{id}/versions` | ë²„ì „ ëª©ë¡ |
| POST | `/prompts/{id}/versions` | ìƒˆ ë²„ì „ ìƒì„± |
| PUT | `/prompts/{id}/versions/{ver}/activate` | ë²„ì „ í™œì„±í™” |
| GET | `/applications` | ì• í”Œë¦¬ì¼€ì´ì…˜ ëª©ë¡ |
| POST | `/applications` | ì• í”Œë¦¬ì¼€ì´ì…˜ ìƒì„± |

#### 3.1.2 promptfoo ì—°ë™

**PromptfooRunner êµ¬í˜„** (`shared/core/promptfoo_runner.py`):

```python
class PromptfooRunner:
    """promptfoo CLI ì‹¤í–‰ ë° ê²°ê³¼ íŒŒì‹±"""

    async def run_eval(
        self,
        prompts: list[dict],
        providers: list[dict],
        tests: list[dict],
    ) -> EvaluationResult:
        """í‰ê°€ ì‹¤í–‰"""
        pass

    def parse_results(self, raw: dict) -> list[TestResult]:
        """ê²°ê³¼ë¥¼ ë‚´ë¶€ ëª¨ë¸ë¡œ ë³€í™˜"""
        pass
```

**ì§€ì› Assertions**:
- `is-json`: JSON í˜•ì‹ ê²€ì¦
- `contains` / `not-contains`: íŠ¹ì • ë¬¸ìì—´ í¬í•¨ ì—¬ë¶€
- `regex`: ì •ê·œì‹ ë§¤ì¹­
- `llm-rubric`: LLM ê¸°ë°˜ í‰ê°€ (promptfoo ë‚´ì¥)

#### 3.1.3 í…ŒìŠ¤íŠ¸ ë°ì´í„°ì…‹ ê´€ë¦¬

**ë°ì´í„° ëª¨ë¸**:

```python
class TestDataset(BaseModel):
    """í…ŒìŠ¤íŠ¸ ë°ì´í„°ì…‹"""
    id: str
    name: str
    description: str | None = None
    created_at: datetime

class TestCase(BaseModel):
    """í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤"""
    id: str
    dataset_id: str
    input: dict[str, str]           # ë³€ìˆ˜ ë°”ì¸ë”©
    expected_output: str | None     # ê¸°ëŒ€ ì¶œë ¥
    metadata: dict | None = None    # ì¶”ê°€ ì •ë³´
```

**API ì—”ë“œí¬ì¸íŠ¸**:

| Method | Endpoint | ì„¤ëª… |
|--------|----------|------|
| GET | `/datasets` | ë°ì´í„°ì…‹ ëª©ë¡ |
| POST | `/datasets` | ë°ì´í„°ì…‹ ìƒì„± |
| GET | `/datasets/{id}/cases` | í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ ëª©ë¡ |
| POST | `/datasets/{id}/cases` | í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ ì¶”ê°€ |
| POST | `/datasets/{id}/import` | CSV/JSON ì¼ê´„ ì—…ë¡œë“œ |

#### 3.1.4 GCP ë°°í¬

- [ ] gcloud CLI ì„¤ì¹˜
- [ ] Cloud SQL ì¸ìŠ¤í„´ìŠ¤ ìƒì„± (PostgreSQL)
- [ ] DB ì½”ë“œ asyncpgë¡œ êµì²´
- [ ] Cloud Run ë°°í¬
- [ ] ë„ë©”ì¸ ì—°ê²° (ì„ íƒ)

#### 3.1.5 ì²´í¬ë¦¬ìŠ¤íŠ¸

- [ ] `PromptVersion` ëª¨ë¸ ì¶”ê°€
- [ ] `Application` ëª¨ë¸ ì¶”ê°€
- [ ] `TestDataset`, `TestCase` ëª¨ë¸ ì¶”ê°€
- [ ] í”„ë¡¬í”„íŠ¸ API ë¼ìš°í„° êµ¬í˜„
- [ ] ì• í”Œë¦¬ì¼€ì´ì…˜ API ë¼ìš°í„° êµ¬í˜„
- [ ] ë°ì´í„°ì…‹ API ë¼ìš°í„° êµ¬í˜„
- [ ] `PromptfooRunner` êµ¬í˜„
- [ ] í…ŒìŠ¤íŠ¸ ì‹¤í–‰ API êµ¬í˜„
- [ ] PostgreSQL ë§ˆì´ê·¸ë ˆì´ì…˜
- [ ] Cloud Run ë°°í¬

---

### 3.2 Phase 3: NEXT (ë°°í¬ í›„)

> ëª©í‘œ: í‰ê°€ ê³ ë„í™” ë° ì‚¬ìš©ì ê²½í—˜ ê°œì„ 

#### 3.2.1 Ragas í‰ê°€ ë©”íŠ¸ë¦­ í†µí•©

promptfooì™€ ë³„ë„ë¡œ Ragas ë©”íŠ¸ë¦­ ì§€ì›:

| ë©”íŠ¸ë¦­ | ì„¤ëª… | ìš©ë„ |
|--------|------|------|
| `faithfulness` | ì‘ë‹µì´ ì»¨í…ìŠ¤íŠ¸ì— ì¶©ì‹¤í•œì§€ | RAG í’ˆì§ˆ |
| `context_precision` | ê´€ë ¨ ì»¨í…ìŠ¤íŠ¸ ë¹„ìœ¨ | RAG í’ˆì§ˆ |
| `answer_relevancy` | ì‘ë‹µì´ ì§ˆë¬¸ê³¼ ê´€ë ¨ìˆëŠ”ì§€ | ì¼ë°˜ í’ˆì§ˆ |
| `answer_semantic_similarity` | ê¸°ëŒ€ ì¶œë ¥ê³¼ ì˜ë¯¸ ìœ ì‚¬ë„ | ì •ë‹µ ë¹„êµ |

**êµ¬í˜„ ë°©ì•ˆ**:
```python
from ragas import evaluate
from ragas.metrics import faithfulness, context_precision

class RagasEvaluator:
    async def evaluate(self, dataset: Dataset) -> dict:
        return evaluate(dataset, metrics=[faithfulness, context_precision])
```

#### 3.2.2 í•©ì„± í…ŒìŠ¤íŠ¸ ë°ì´í„° ìƒì„±

ì‹œë“œ ë¬¸ì„œ ê¸°ë°˜ Q/A ìŒ ìë™ ìƒì„±:

```python
from ragas.testset import TestsetGenerator

class SyntheticDataGenerator:
    """í•©ì„± í…ŒìŠ¤íŠ¸ ë°ì´í„° ìƒì„±ê¸°"""

    async def generate_from_documents(
        self,
        documents: list[str],
        num_questions: int = 10
    ) -> list[TestCase]:
        """ë¬¸ì„œì—ì„œ Q/A ìŒ ìƒì„±"""
        pass
```

**ì§€ì› ì†ŒìŠ¤**:
- í…ìŠ¤íŠ¸ íŒŒì¼
- PDF
- CSV
- (í–¥í›„) ë²¡í„° DB ì»¬ë ‰ì…˜

#### 3.2.3 Golden/Evaluation Dataset ë¶„ë¦¬

| ë°ì´í„°ì…‹ | ìš©ë„ | íŠ¹ì§• |
|---------|------|------|
| **Golden Dataset** | ê¸°ì¤€ì„  ê²€ì¦ | ì†ŒëŸ‰, ì‚¬ëŒì´ ê²€ìˆ˜, ì‹ ë¢°ë„ ë†’ìŒ |
| **Evaluation Dataset** | ì»¤ë²„ë¦¬ì§€ í™•ì¥ | ëŒ€ëŸ‰, í•©ì„± ë°ì´í„° í¬í•¨ |

**ë°ì´í„° ëª¨ë¸ í™•ì¥**:
```python
class TestDataset(BaseModel):
    # ... ê¸°ì¡´ í•„ë“œ
    dataset_type: Literal["golden", "evaluation"] = "evaluation"
    is_verified: bool = False  # ì‚¬ëŒ ê²€ìˆ˜ ì—¬ë¶€
```

#### 3.2.4 ì‹¤í—˜ ë¹„êµ ëŒ€ì‹œë³´ë“œ

- í”„ë¡¬í”„íŠ¸ ë²„ì „ë³„ í‰ê°€ ê²°ê³¼ ë¹„êµ
- ëª¨ë¸ë³„ ì„±ëŠ¥ ë¹„êµ
- ì‹œê°„ë³„ íŠ¸ë Œë“œ ê·¸ë˜í”„
- í”¼ë²— í…Œì´ë¸” í˜•íƒœ ê²°ê³¼ ë·°

#### 3.2.5 ë¹„ê°œë°œììš© UI

Streamlit ë˜ëŠ” Next.js ê°„ì†Œí™” ë²„ì „:
- í”„ë¡¬í”„íŠ¸ ì„ íƒ (ë“œë¡­ë‹¤ìš´)
- í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ ì…ë ¥ (í¼)
- ì‹¤í–‰ ë²„íŠ¼
- ê²°ê³¼ í™•ì¸ (Pass/Fail ë±ƒì§€)

#### 3.2.6 ì²´í¬ë¦¬ìŠ¤íŠ¸

- [ ] Ragas ë¼ì´ë¸ŒëŸ¬ë¦¬ í†µí•©
- [ ] í‰ê°€ ë©”íŠ¸ë¦­ ì„ íƒ UI
- [ ] í•©ì„± ë°ì´í„° ìƒì„±ê¸° êµ¬í˜„
- [ ] Golden/Evaluation ë°ì´í„°ì…‹ ë¶„ë¦¬
- [ ] ì‹¤í—˜ ë¹„êµ ëŒ€ì‹œë³´ë“œ
- [ ] ë¹„ê°œë°œììš© ê°„ì†Œí™” UI

---

### 3.3 Phase 4: FUTURE (ì¥ê¸° ë¹„ì „)

> ëª©í‘œ: ì—”í„°í”„ë¼ì´ì¦ˆ ìˆ˜ì¤€ì˜ LLMOps í”Œë«í¼

#### 3.3.1 Langfuse í†µí•©

**ë„ì… ì´ìœ ** (ìš°ì•„í•œí˜•ì œë“¤ ì„ íƒ ê¸°ì¤€):
- í”„ë¡¬í”„íŠ¸ ê´€ë¦¬ & ë²„ì „ ì œì–´
- Trace ê¸°ë°˜ Observability
- í† í°/ë¹„ìš© ëŒ€ì‹œë³´ë“œ
- ì‹¤í—˜/í‰ê°€ ì›Œí¬í”Œë¡œìš°
- ì˜¤í”ˆì†ŒìŠ¤, Self-hosted ê°€ëŠ¥

**í†µí•© ë²”ìœ„**:
```
ê¸°ì¡´ Studio ê¸°ëŠ¥ â†’ Langfuse ëŒ€ì²´
- í”„ë¡¬í”„íŠ¸ ë²„ì €ë‹
- Trace ë¡œê¹…
- ë¹„ìš© ëª¨ë‹ˆí„°ë§
```

#### 3.3.2 LiteLLM ì „í™˜

í˜„ì¬ `shared/adapters/` â†’ LiteLLM ê¸°ë°˜ìœ¼ë¡œ ì „í™˜:

```python
from litellm import completion

# ëª¨ë¸ëª…ë§Œ ë°”ê¾¸ë©´ ëª¨ë“  í”„ë¡œë°”ì´ë” ì§€ì›
response = completion(
    model="together_ai/meta-llama/Llama-3-70b",
    messages=[{"role": "user", "content": "Hello"}]
)
```

**ì¥ì **:
- 100+ í”„ë¡œë°”ì´ë” ì§€ì›
- Fallback/Load Balancing ë‚´ì¥
- ë¹„ìš© ì¶”ì  ë‚´ì¥

#### 3.3.3 OpenAI-Compatible API Gateway

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  External App   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚ OpenAI API ìŠ¤í™
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  API Gateway    â”‚ â† ì¸ì¦, ë¼ìš°íŒ…, ë¡œê¹…
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  LLM Providers  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 3.3.4 Observability íŒŒì´í”„ë¼ì¸

```
Application â†’ Langfuse (Traces) â†’ ClickHouse
                                      â”‚
                                      â–¼
                               Superset (Dashboard)
                                      â”‚
                                      â–¼
                               Grafana (Alerting)
```

**ì¶”ì  í•­ëª©**:
- ìš”ì²­/ì‘ë‹µ ì „ë¬¸
- ì§€ì—° ì‹œê°„ (Percentile)
- í† í° ì‚¬ìš©ëŸ‰
- ë¹„ìš©
- ì˜¤ë¥˜ìœ¨

#### 3.3.5 PII í•„í„°ë§

ìš”ì²­ ì „ ê°œì¸ì •ë³´ íƒì§€/ë§ˆìŠ¤í‚¹:

```python
class PIIFilter:
    """ê°œì¸ì •ë³´ í•„í„°"""

    PATTERNS = {
        "phone": r"\d{3}-\d{4}-\d{4}",
        "email": r"[\w.-]+@[\w.-]+\.\w+",
        "rrn": r"\d{6}-\d{7}",  # ì£¼ë¯¼ë“±ë¡ë²ˆí˜¸
    }

    def filter(self, text: str) -> str:
        """PII ë§ˆìŠ¤í‚¹"""
        pass

    def detect(self, text: str) -> list[str]:
        """PII íƒì§€"""
        pass
```

#### 3.3.6 Retry/Fallback ì „ëµ

```python
class LLMRouter:
    """ì¥ì•  ëŒ€ì‘ ë¼ìš°í„°"""

    async def call_with_fallback(
        self,
        prompt: str,
        primary: str = "together_ai/llama-3",
        fallback: str = "openai/gpt-4o-mini"
    ) -> Response:
        try:
            return await self.call(primary, prompt)
        except (TimeoutError, ServiceUnavailable):
            return await self.call(fallback, prompt)
```

#### 3.3.7 ì²´í¬ë¦¬ìŠ¤íŠ¸

- [ ] Langfuse Self-hosted ë°°í¬
- [ ] ê¸°ì¡´ ì‹œìŠ¤í…œ â†’ Langfuse ë§ˆì´ê·¸ë ˆì´ì…˜
- [ ] LiteLLM ì „í™˜
- [ ] API Gateway ë ˆì´ì–´ êµ¬ì¶•
- [ ] Observability íŒŒì´í”„ë¼ì¸ (ClickHouse + Superset)
- [ ] PII í•„í„° êµ¬í˜„
- [ ] Retry/Fallback ì „ëµ êµ¬í˜„
- [ ] ë¹„ìš© ì•Œë¦¼ ì‹œìŠ¤í…œ

---

## 4. ìš°ì„ ìˆœìœ„ ë§¤íŠ¸ë¦­ìŠ¤

```
                    ë†’ì€ ì˜í–¥
                       â”‚
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚                 â”‚                 â”‚
     â”‚  [Langfuse]     â”‚  [í”„ë¡¬í”„íŠ¸      â”‚
     â”‚  [LiteLLM]      â”‚   ë²„ì €ë‹]       â”‚
     â”‚  [Observability]â”‚  [promptfoo]    â”‚
ë‚®ì€ â”‚                 â”‚  [í…ŒìŠ¤íŠ¸ì…‹ DB]  â”‚ ë†’ì€
ë…¸ë ¥ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ ë…¸ë ¥
     â”‚                 â”‚                 â”‚
     â”‚  [ë¹„ê°œë°œì UI]  â”‚  [Ragas í†µí•©]   â”‚
     â”‚  [PII í•„í„°]     â”‚  [í•©ì„± ë°ì´í„°]  â”‚
     â”‚                 â”‚  [API Gateway]  â”‚
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                    ë‚®ì€ ì˜í–¥
```

**Quick Wins** (ë†’ì€ ì˜í–¥, ë‚®ì€ ë…¸ë ¥):
- í”„ë¡¬í”„íŠ¸ ë²„ì €ë‹
- promptfoo ì—°ë™
- í…ŒìŠ¤íŠ¸ì…‹ DBí™”

**Strategic** (ë†’ì€ ì˜í–¥, ë†’ì€ ë…¸ë ¥):
- Langfuse í†µí•©
- LiteLLM ì „í™˜
- Observability

---

## 5. ì°¸ê³  ìë£Œ

### 5.1 Naver D2
- [LLMOpsë¥¼ ìœ„í•œ í”„ë¡¬í”„íŠ¸ ì—”ì§€ë‹ˆì–´ë§ ë„êµ¬ ê°œë°œ ê²½í—˜ê¸°](https://d2.naver.com/helloworld/3344073)

### 5.2 ìš°ì•„í•œí˜•ì œë“¤
- [AIí”Œë«í¼ 2.0 - LLMOps](https://techblog.woowahan.com/22839/)

### 5.3 ë„êµ¬/ë¼ì´ë¸ŒëŸ¬ë¦¬
- [Langfuse](https://langfuse.com/) - LLM Observability
- [LiteLLM](https://github.com/BerriAI/litellm) - í†µí•© LLM ì¸í„°í˜ì´ìŠ¤
- [Ragas](https://docs.ragas.io/) - RAG í‰ê°€ í”„ë ˆì„ì›Œí¬
- [promptfoo](https://promptfoo.dev/) - í”„ë¡¬í”„íŠ¸ í…ŒìŠ¤íŠ¸
- [ARES](https://github.com/stanford-futuredata/ARES) - Stanford í‰ê°€ ë„êµ¬

### 5.4 ê¸°íƒ€
- [LangChain Data Generation](https://python.langchain.com/v0.1/docs/use_cases/data_generation/)
- [Ragas Testset Generation](https://docs.ragas.io/en/latest/concepts/testset_generation.html)
